# PCA9685四电机差速控制系统接线图

## 系统总体接线示意

```
+-------------+        I2C         +--------------+
| 树莓派5 GPIO |<----------------->| PCA9685 PWM  |
|             |                    | 控制器        |
+-------------+                    +--------------+
      |                                   |
      | GPIO直连                           | PWM信号
      |                                   |
      v                                   v
+-------------+                    +--------------+
| D电机控制引脚 |                    | A/B/C电机控制 |
| (GPIO 24/25)|                    | (PWM通道)     |
+-------------+                    +--------------+
      |                                   |
      v                                   v
+-------------+                    +--------------+
|   右后电机   |                    | 左前/右前/左后 |
|   (D电机)    |                    | 电机          |
+-------------+                    +--------------+
```

## 详细接线说明

### 1. 树莓派5与PCA9685连接

| 树莓派5引脚 | PCA9685引脚 | 说明 |
|------------|------------|------|
| 3.3V/5V    | VCC        | 电源，建议使用5V |
| GND        | GND        | 地线 |
| GPIO 2 (SDA)| SDA       | I2C数据线 |
| GPIO 3 (SCL)| SCL       | I2C时钟线 |

### 2. PCA9685与电机驱动板连接

#### 左前电机(A电机)
| PCA9685通道 | 电机驱动引脚 | 说明 |
|------------|------------|------|
| 通道0       | PWM-A      | 电机PWM速度控制 |
| 通道1       | IN2-A      | 电机方向控制 |
| 通道2       | IN1-A      | 电机方向控制 |

#### 右前电机(B电机)
| PCA9685通道 | 电机驱动引脚 | 说明 |
|------------|------------|------|
| 通道5       | PWM-B      | 电机PWM速度控制 |
| 通道3       | IN1-B      | 电机方向控制 |
| 通道4       | IN2-B      | 电机方向控制 |

#### 左后电机(C电机)
| PCA9685通道 | 电机驱动引脚 | 说明 |
|------------|------------|------|
| 通道6       | PWM-C      | 电机PWM速度控制 |
| 通道7       | IN2-C      | 电机方向控制 |
| 通道8       | IN1-C      | 电机方向控制 |

#### 右后电机(D电机) - 混合模式
| 控制器       | 引脚        | 电机驱动引脚 | 说明 |
|------------|------------|------------|------|
| PCA9685    | 通道11      | PWM-D      | 电机PWM速度控制 |
| 树莓派5      | GPIO 24    | IN2-D      | 电机方向控制 |
| 树莓派5      | GPIO 25    | IN1-D      | 电机方向控制 |

### 3. 电机驱动与直流电机连接

| 电机驱动输出 | 直流电机 | 说明 |
|------------|--------|------|
| 输出A+      | 左前电机+ | 接电机正极 |
| 输出A-      | 左前电机- | 接电机负极 |
| 输出B+      | 右前电机+ | 接电机正极 |
| 输出B-      | 右前电机- | 接电机负极 |
| 输出C+      | 左后电机+ | 接电机正极 |
| 输出C-      | 左后电机- | 接电机负极 |
| 输出D+      | 右后电机+ | 接电机正极 |
| 输出D-      | 右后电机- | 接电机负极 |

## 电源接线

### 1. 供电方案

推荐使用独立电源供电：
- 树莓派5: 5V电源适配器或移动电源
- 电机驱动: 7.4V-12V锂电池或镍氢电池

### 2. 共地处理

重要：所有模块必须共地，将以下地线连接到一起：
- 树莓派5的GND
- PCA9685的GND
- 电机驱动板的GND
- 电源负极

## 注意事项

1. **电平转换**：如果电机驱动需要的逻辑电平与PCA9685输出不匹配，需要使用电平转换器

2. **电机方向**：如果电机转向与预期相反，可交换电机的两个接线

3. **I2C总线**：确保I2C总线上没有地址冲突的设备

4. **散热**：对于大电流电机，需要为电机驱动和PCA9685提供适当散热

5. **干扰抑制**：电机可能产生干扰，建议在电机两端并联0.1uF电容

6. **保护电路**：考虑添加保险丝和二极管保护电路

7. **外部电源**：当使用外部电源时，需要将PCA9685的V+连接到外部电源

## 扩展接线

如需添加编码器反馈，请按如下连接：
- 左前编码器A相: GPIO 17
- 左前编码器B相: GPIO 18
- 右前编码器A相: GPIO 22
- 右前编码器B相: GPIO 23

## 接线检查清单

在通电前，请检查：
- [ ] I2C连接是否正确
- [ ] 电机驱动引脚连接是否对应正确的通道
- [ ] 所有地线是否已连接
- [ ] 电源电压是否在安全范围内
- [ ] 是否有短路的风险 